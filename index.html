<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Permainan Kosa Kata BM-CN-EN</title>
<style>
    body {
        font-family: 'Comic Sans MS', cursive, sans-serif;
        background: linear-gradient(to bottom, #ffecd2, #fcb69f);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        text-align: center;
    }
    h1 { color: #ff5722; margin-bottom: 10px; }
    #game-box {
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        max-width: 400px; width: 90%;
    }
    .word { font-size: 1.8em; font-weight: bold; margin-bottom: 20px; color: #333; }
    .option {
        font-size: 1.1em;
        background: #ff9800;
        color: white;
        padding: 10px;
        margin: 8px 0;
        border-radius: 10px;
        cursor: pointer;
        transition: transform 0.2s, background 0.2s;
    }
    .option:hover { background: #f57c00; transform: scale(1.05); }
    #score, #timer, #progress { font-size: 1.2em; margin: 10px 0; }
    .correct { background: #4caf50 !important; }
    .wrong { background: #e91e63 !important; }

    #message {
        position: fixed; inset: 0; display: grid; place-items: center; pointer-events: none; z-index: 1000;
    }
    .msg {
        display: inline-flex; align-items: center; gap: .6rem;
        padding: .8rem 1.4rem; border-radius: 20px;
        font-size: clamp(20px, 5vw, 40px); font-weight: 900;
        color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        transform: scale(.5); opacity: 0;
        font-family: 'Comic Sans MS', cursive, sans-serif;
    }
    .msg.success { background: linear-gradient(135deg,#00c853,#64dd17); border: 3px solid #aeea00; }
    .msg.error   { background: linear-gradient(135deg,#ff5252,#e91e63); border: 3px solid #ff8a80; }
    .msg.show { animation: popKids 1500ms cubic-bezier(.2,.9,.25,1) forwards; }
    @keyframes popKids {
        0%   { transform: scale(.5); opacity: 0; }
        35%  { transform: scale(1.3); opacity: 1; }
        70%  { transform: scale(1.0); opacity: 1; }
        100% { transform: scale(.8); opacity: 0; }
    }

    #fx { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }

    /* Tamat screen */
    #end-screen {
        position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
        background: rgba(0,0,0,0.5); z-index: 2000; visibility: hidden;
    }
    #end-card {
        background: #fff; padding: 20px 30px; border-radius: 15px; text-align: center;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        max-width: 350px;
    }
    #end-card h2 { color: #ff5722; margin-bottom: 15px; }
    #end-card button {
        background: #ff9800; border: none; color: #fff; padding: 10px 20px;
        border-radius: 10px; font-size: 1em; cursor: pointer; margin-top: 15px;
    }
    #end-card button:hover { background: #f57c00; }
</style>
</head>
<body>
<h1>üéØ Permainan Kosa Kata</h1>
<div id="game-box">
    <div id="timer">‚è≥ Masa: 0:00</div>
    <div id="score">Markah: 0</div>
    <div id="progress">Soalan: 0/21</div>
    <div class="word" id="word">...</div>
    <div id="options"></div>
</div>

<div id="message" aria-live="polite" role="status"></div>
<canvas id="fx"></canvas>

<!-- End screen -->
<div id="end-screen">
  <div id="end-card">
    <h2>Permainan Tamat!</h2>
    <p id="final-score"></p>
    <p id="final-time"></p>
    <button onclick="startGame()">Ulang Semula</button>
  </div>
</div>

<script>
const vocab = [
    { bm: "Pemergian", cn: "Á¶ªÂéª", en: "Journey" },
    { bm: "Menyentuh", cn: "ËΩªËß¶", en: "Touch" },
    { bm: "Penduduk", cn: "Â±ÖÊ∞ë", en: "Resident" },
    { bm: "Perasaan", cn: "ÊÑüÂèó", en: "Feeling" },
    { bm: "Saudara-mara", cn: "‰∫≤Êàö", en: "Relatives" },
    { bm: "Kenal", cn: "ËÆ§ËØÜ", en: "Know" },
    { bm: "Segan", cn: "Áæû", en: "Shy" },
    { bm: "Kebahagiaan", cn: "Âπ∏Á¶è", en: "Happiness" },
    { bm: "Kesihatan", cn: "ÂÅ•Â∫∑", en: "Health" },
    { bm: "Pelajaran", cn: "Â≠¶‰π†", en: "Study" },
    { bm: "Pekerjaan", cn: "Â∑•‰Ωú", en: "Job" },
    { bm: "Kecantikan", cn: "Áæé‰∏Ω", en: "Beauty" },
    { bm: "Kekuatan", cn: "ÂäõÈáè", en: "Strength" },
    { bm: "Kelemahan", cn: "Âº±ÁÇπ", en: "Weakness" },
    { bm: "Kemerdekaan", cn: "Áã¨Á´ã", en: "Independence" },
    { bm: "Pertolongan", cn: "Â∏ÆÂä©", en: "Help" },
    { bm: "Perjumpaan", cn: "ËÅö‰ºö", en: "Meeting" },
    { bm: "Pertandingan", cn: "ÊØîËµõ", en: "Competition" },
    { bm: "Perkongsian", cn: "ÂàÜ‰∫´", en: "Sharing" },
    { bm: "Persahabatan", cn: "ÂèãË∞ä", en: "Friendship" },
    { bm: "Penerokaan", cn: "Êé¢Á¥¢", en: "Exploration" }
];

let score=0, timeLeft=0, timer, startTime;
let questions=[], currentQ;
let animTimeout;
const totalQuestions = vocab.length;
let answeredCount = 0;

function startTimer(){
    startTime = Date.now();
    timer = setInterval(()=>{
        timeLeft = Math.floor((Date.now()-startTime)/1000);
        let m=Math.floor(timeLeft/60), s=timeLeft%60;
        document.getElementById("timer").innerText=`‚è≥ Masa: ${m}:${s.toString().padStart(2,"0")}`;
    },1000);
}

function startGame(){
    document.getElementById("end-screen").style.visibility="hidden";
    score=0; answeredCount=0; questions=[...vocab];
    document.getElementById("score").innerText="Markah: 0";
    if(timer) clearInterval(timer); startTimer();
    document.getElementById("progress").innerText = `Soalan: 0/${totalQuestions}`;
    nextQuestion();
}

function nextQuestion(){
    if(questions.length===0){ endGame(); return; }
    currentQ = questions.splice(Math.floor(Math.random()*questions.length),1)[0];
    document.getElementById("word").innerText=currentQ.bm;
    document.getElementById("progress").innerText = `Soalan: ${answeredCount+1}/${totalQuestions}`;

    let correctAns = Math.random()<0.5? currentQ.cn: currentQ.en;
    let options=[correctAns];
    while(options.length<4){
        let rnd=vocab[Math.floor(Math.random()*vocab.length)];
        let ans=Math.random()<0.5? rnd.cn: rnd.en;
        if(!options.includes(ans)) options.push(ans);
    }
    options.sort(()=>Math.random()-0.5);

    let optDiv=document.getElementById("options");
    optDiv.innerHTML="";
    options.forEach(opt=>{
        const btn=document.createElement("div");
        btn.className="option";
        btn.innerText=opt;
        btn.onclick=()=>checkAnswer(opt,correctAns,btn);
        optDiv.appendChild(btn);
    });
}

function showMessage({text, type='success', after}){
    const holder = document.getElementById('message');
    clearTimeout(animTimeout);
    holder.innerHTML = `<div class="msg ${type}">${text}</div>`;
    const badge = holder.firstElementChild;
    requestAnimationFrame(()=> badge.classList.add('show'));
    animTimeout = setTimeout(()=>{
        badge.classList.remove('show');
        if (typeof after === 'function') after();
    }, 1500);
}

function checkAnswer(choice,correct,btn){
    if(choice===correct){
        btn.classList.add("correct");
        showMessage({ text: "Tahniah! üèÜ", type: 'success', after: ()=>{
            launchConfetti();
            score++;
            answeredCount++;
            document.getElementById("score").innerText="Markah: "+score;
            setTimeout(nextQuestion,500);
        }});
    } else {
        btn.classList.add("wrong");
        if(score>0) score--;
        document.getElementById("score").innerText="Markah: "+score;
        showMessage({ text: "Cuba lagi! ‚úñÔ∏è", type: 'error' });
    }
}

const canvas=document.getElementById("fx"),ctx=canvas.getContext("2d");
function sizeCanvas(){ canvas.width=innerWidth; canvas.height=innerHeight; }
sizeCanvas(); addEventListener('resize', sizeCanvas);
let particles=[];
function launchConfetti(){
    for(let i=0;i<150;i++){
        particles.push({
            x:canvas.width/2, y:canvas.height/2,
            dx:(Math.random()-0.5)*7, dy:Math.random()*-7-3,
            size:Math.random()*6+3,
            color:`hsl(${Math.random()*360},100%,50%)`,
            life:100
        });
    }
}
function animateConfetti(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach((p,i)=>{
        p.x+=p.dx; p.y+=p.dy; p.dy+=0.15; p.life--;
        ctx.fillStyle=p.color;
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
        ctx.fill();
        if(p.life<=0) particles.splice(i,1);
    });
    requestAnimationFrame(animateConfetti);
}
animateConfetti();

function endGame(){
    clearInterval(timer);
    document.getElementById("end-screen").style.visibility="visible";
    document.getElementById("final-score").innerText = `Markah akhir: ${score}/${totalQuestions}`;
    document.getElementById("final-time").innerText = `Masa diambil: ${Math.floor(timeLeft/60)} minit ${timeLeft%60} saat`;
}

startGame();
</script>
</body>
</html>
