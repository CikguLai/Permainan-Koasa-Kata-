<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Permainan Kosa Kata BM-CN-EN</title>
<style>
  body {
    font-family: 'Comic Neue', 'Comic Sans MS', cursive, sans-serif;
    background: linear-gradient(to bottom, #ffecd2, #fcb69f);
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    height: 100vh; margin: 0; text-align: center;
  }
  h1 { color: #ff5722; margin-bottom: 10px; }
  #game-box {
    background: white; padding: 20px; border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2); max-width: 420px; width: 92%;
  }
  .word { font-size: 1.8em; font-weight: bold; margin-bottom: 20px; color: #333; }
  .option {
    font-size: 1.1em; background: #ff9800; color: white; padding: 12px;
    margin: 8px 0; border-radius: 10px; cursor: pointer;
    transition: transform 0.2s, background 0.2s;
  }
  .option:hover { background: #f57c00; transform: scale(1.05); }
  #score, #timer, #progress { font-size: 1.1em; margin: 8px 0; }
  .correct { background: #4caf50 !important; }
  .wrong { background: #e91e63 !important; }

  /* Mesej tengah */
  #message { position: fixed; inset: 0; display: grid; place-items: center; pointer-events: none; z-index: 1000; }
  .msg {
    display: inline-flex; align-items: center; gap: .6rem; padding: .8rem 1.4rem; border-radius: 20px;
    font-size: clamp(22px, 5vw, 42px); font-weight: 900; color: #fff;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3); transform: scale(.3); opacity: 0;
  }
  .msg.success { background: linear-gradient(135deg,#00c853,#64dd17); border: 3px solid #aeea00; }
  .msg.error   { background: linear-gradient(135deg,#ff5252,#e91e63); border: 3px solid #ff8a80; }
  .msg.show { animation: popKids 500ms cubic-bezier(.25,.9,.35,1) forwards; }
  @keyframes popKids {
    0% { transform: scale(.3); opacity: 0; }
    30% { transform: scale(1.2); opacity: 1; }
    70% { transform: scale(1.0); opacity: 1; }
    100% { transform: scale(.95); opacity: 0; }
  }

  /* Confetti canvas */
  #fx { position: fixed; inset: 0; pointer-events: none; z-index: 999; }

  /* Paparan tamat */
  #end-screen {
    position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
    background: rgba(0,0,0,0.5); z-index: 2000; visibility: hidden;
  }
  #end-card { background: #fff; padding: 22px 26px; border-radius: 15px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.3); max-width: 360px; }
  #end-card h2 { color: #ff5722; margin: 0 0 12px; }
  #end-card button { background: #ff9800; border: none; color: #fff; padding: 10px 20px; border-radius: 10px; font-size: 1em; cursor: pointer; margin-top: 12px; }
  #end-card button:hover { background: #f57c00; }
</style>
<link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <h1>üéØ Permainan Kosa Kata</h1>
  <div id="game-box">
    <div id="timer">‚è≥ Masa: 0:00</div>
    <div id="score">Markah: 0</div>
    <div id="progress">Soalan: 0/21</div>
    <div class="word" id="word">...</div>
    <div id="options"></div>
  </div>

  <div id="message" aria-live="polite" role="status"></div>
  <canvas id="fx"></canvas>

  <!-- End screen -->
  <div id="end-screen">
    <div id="end-card">
      <h2>Permainan Tamat!</h2>
      <p id="final-score"></p>
      <p id="final-time"></p>
      <button id="restart">Ulang Semula</button>
    </div>
  </div>

<script>
// ====== DATA 21 soalan ======
const vocab = [
  { bm: "Pemergian", cn: "Á¶ªÂéª", en: "Departure" },
  { bm: "Menyentuh", cn: "ËΩªËß¶", en: "Touch" },
  { bm: "Penduduk", cn: "Â±ÖÊ∞ë", en: "Resident" },
  { bm: "Perasaan", cn: "ÊÑüÂèó", en: "Feeling" },
  { bm: "Saudara-mara", cn: "‰∫≤Êàö", en: "Relatives" },
  { bm: "Kenal", cn: "ËÆ§ËØÜ", en: "Know" },
  { bm: "Segan", cn: "Áæû", en: "Shy" },
  { bm: "Kebahagiaan", cn: "Âπ∏Á¶è", en: "Happiness" },
  { bm: "Kesihatan", cn: "ÂÅ•Â∫∑", en: "Health" },
  { bm: "Pelajaran", cn: "Â≠¶‰π†", en: "Study" },
  { bm: "Pekerjaan", cn: "Â∑•‰Ωú", en: "Job" },
  { bm: "Kecantikan", cn: "Áæé‰∏Ω", en: "Beauty" },
  { bm: "Kekuatan", cn: "ÂäõÈáè", en: "Strength" },
  { bm: "Kelemahan", cn: "Âº±ÁÇπ", en: "Weakness" },
  { bm: "Kemerdekaan", cn: "Áã¨Á´ã", en: "Independence" },
  { bm: "Pertolongan", cn: "Â∏ÆÂä©", en: "Help" },
  { bm: "Perjumpaan", cn: "ËÅö‰ºö", en: "Meeting" },
  { bm: "Pertandingan", cn: "ÊØîËµõ", en: "Competition" },
  { bm: "Perkongsian", cn: "ÂàÜ‰∫´", en: "Sharing" },
  { bm: "Persahabatan", cn: "ÂèãË∞ä", en: "Friendship" },
  { bm: "Penerokaan", cn: "Êé¢Á¥¢", en: "Exploration" }
];

// ====== STATE ======
let score = 0, answeredCount = 0;
let questions = [], currentQ = null;
const totalQuestions = vocab.length;
let timer = null, startTime = 0, elapsed = 0;
let animTimeout;

// ====== UTIL ======
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } }

// ====== TIMER ======
function startTimer(){
  startTime = Date.now();
  if (timer) clearInterval(timer);
  timer = setInterval(()=>{
    elapsed = Math.floor((Date.now()-startTime)/1000);
    const m = Math.floor(elapsed/60), s = elapsed%60;
    document.getElementById('timer').innerText = `‚è≥ Masa: ${m}:${s.toString().padStart(2,'0')}`;
  },1000);
}

// ====== UI MESSAGE ======
function showMessage({text, type='success', after}){
  const holder = document.getElementById('message');
  clearTimeout(animTimeout);
  holder.innerHTML = `<div class="msg ${type}">${text}</div>`;
  const badge = holder.firstElementChild;
  requestAnimationFrame(()=> badge.classList.add('show'));
  animTimeout = setTimeout(()=>{
    badge.classList.remove('show');
    if (typeof after === 'function') after();
  }, 700);
}

// ====== CONFETTI (library) ======
function launchConfetti(){
  const duration = 700; // lebih pantas & natural
  const end = Date.now() + duration;
  (function frame(){
    confetti({ particleCount: 5, angle: 60, spread: 60, startVelocity: 45, gravity: 0.9, origin: {x:0}, colors: ['#ff0','#0f0','#00f','#f0f']});
    confetti({ particleCount: 5, angle: 120, spread: 60, startVelocity: 45, gravity: 0.9, origin: {x:1}, colors: ['#ff0','#0f0','#00f','#f0f']});
    if (Date.now() < end) requestAnimationFrame(frame);
  })();
}

// ====== GAME FLOW ======
function startGame(){
  document.getElementById('end-screen').style.visibility = 'hidden';
  score = 0; answeredCount = 0; questions = [...vocab]; shuffle(questions);
  document.getElementById('score').innerText = 'Markah: 0';
  document.getElementById('progress').innerText = `Soalan: 0/${totalQuestions}`;
  startTimer();
  nextQuestion();
}

function nextQuestion(){
  if (questions.length === 0){ endGame(); return; }
  currentQ = questions.shift();
  document.getElementById('word').innerText = currentQ.bm;
  document.getElementById('progress').innerText = `Soalan: ${answeredCount+1}/${totalQuestions}`;

  const correctLang = Math.random() < 0.5 ? 'cn' : 'en';
  const otherLang = correctLang === 'cn' ? 'en' : 'cn';
  const correctAns = currentQ[correctLang];
  const bannedTwin = currentQ[otherLang];

  let options = [correctAns];
  while (options.length < 4){
    const rnd = vocab[Math.floor(Math.random()*vocab.length)];
    const pick = Math.random() < 0.5 ? rnd.cn : rnd.en;
    if (!pick) continue;
    if (pick === correctAns) continue;
    if (pick === bannedTwin) continue;
    if (options.includes(pick)) continue;
    options.push(pick);
  }
  shuffle(options);

  const box = document.getElementById('options');
  box.innerHTML = '';
  options.forEach(opt => {
    const btn = document.createElement('div');
    btn.className = 'option';
    btn.innerText = opt;
    btn.onclick = () => checkAnswer(opt, correctAns, btn);
    box.appendChild(btn);
  });
}

function checkAnswer(choice, correct, btn){
  if (choice === correct){
    btn.classList.add('correct');
    showMessage({ text: 'Tahniah! üèÜ', type: 'success' });
    setTimeout(()=> launchConfetti(), 80);

    score++; answeredCount++;
    document.getElementById('score').innerText = 'Markah: ' + score;
    const isLast = answeredCount >= totalQuestions;
    setTimeout(()=>{ isLast ? endGame() : nextQuestion(); }, isLast ? 700 : 500);
  } else {
    btn.classList.add('wrong');
    if (score > 0) score--;
    document.getElementById('score').innerText = 'Markah: ' + score;
    showMessage({ text: 'Cuba lagi! ‚úñÔ∏è', type: 'error' });
  }
}

function endGame(){
  clearInterval(timer);
  document.getElementById('final-score').innerText = `Markah akhir: ${score}/${totalQuestions}`;
  document.getElementById('final-time').innerText = `Masa diambil: ${Math.floor(elapsed/60)} minit ${elapsed%60} saat`;
  document.getElementById('end-screen').style.visibility = 'visible';
}

document.getElementById('restart').addEventListener('click', startGame);

// mula permainan
startGame();
</script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</body>
</html>
